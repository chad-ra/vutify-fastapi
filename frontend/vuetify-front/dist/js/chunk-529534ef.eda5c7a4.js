(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-529534ef"],{"715e":function(t,a,e){"use strict";e("cc12b")},c2dd:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("waiting-modal",{attrs:{title:t.title,status:t.status,active:t.active_waiting},on:{statusdailog:t.update_status_wait}}),e("v-container",[e("v-row",{staticClass:"align-center d-flex h-0 pb-20"},[e("v-col",{staticClass:"mx-auto",staticStyle:{"text-align":"center"},attrs:{xl:"3",lg:"4",sm:"9"}},[e("v-card",{staticClass:"bg-orange"},[e("span",{staticClass:"text-purple"},[t._v("สแกนเพื่อเพิ่มผู้ป่วยในการดูแล")])]),e("br"),e("v-row",{},[e("v-col",{staticStyle:{"text-align":"center"},attrs:{cols:"12"}},[e("div",[e("v-card",{attrs:{height:"300"}},[e("v-card-text",[e("qrcode-stream",{on:{decode:t.onDecode,init:t.onInit}}),e("br"),e("span",[t._v("สแกน QR ผู้ป่วย")])],1)],1)],1)])],1)],1)],1),e("v-row",{directives:[{name:"show",rawName:"v-show",value:!t.$vuetify.breakpoint.mobile,expression:"!$vuetify.breakpoint.mobile"}],staticClass:"align-center",staticStyle:{"padding-top":"15px"}},[e("v-col",{staticClass:"mx-auto",staticStyle:{"text-align":"left"},attrs:{lg:"3",sm:"9"}},[e("v-btn",{staticClass:"border-radius-xl",staticStyle:{"border-color":"#d6d6d629"},attrs:{outlined:"",color:"purple"},on:{click:function(a){return t.$router.go(-1)}}},[e("v-icon",{attrs:{small:""}},[t._v("west")])],1),t._v("         "),e("v-btn",{staticClass:"border-radius-xl",staticStyle:{width:"250px"},attrs:{color:"bg-primary text-white"},on:{click:function(a){return t.$router.push("/add_patient_manual")}}},[t._v(" เพิ่มข้อมูลเอง ")])],1)],1),e("v-footer",{directives:[{name:"show",rawName:"v-show",value:t.$vuetify.breakpoint.mobile,expression:"$vuetify.breakpoint.mobile"}],staticClass:"action-nav",staticStyle:{height:"60px"},attrs:{fixed:""}},[e("v-row",{staticClass:"align-left"},[e("v-btn",{staticClass:"border-radius-xl",staticStyle:{"border-color":"#d6d6d629"},attrs:{outlined:"",color:"purple"},on:{click:function(a){return t.$router.go(-1)}}},[e("v-icon",{attrs:{small:""}},[t._v("west")])],1),t._v("         "),e("v-btn",{staticClass:"border-radius-xl",staticStyle:{width:"250px"},attrs:{color:"bg-primary text-white"},on:{click:function(a){return t.$router.push("/add_patient_manual")}}},[t._v(" เพิ่มข้อมูลเอง ")])],1)],1)],1)],1)},r=[],s=e("087d"),o=e("5fb0"),n=e("2b0e"),c=e("bb6f"),l={name:"scan_add_patient",components:{QrcodeStream:c["QrcodeStream"],WaitingModal:s["a"]},data:()=>({isValid:void 0,camera:"auto",result:null,token:"",size:100,active_waiting:!1,status:"",alert_name:""}),mounted(){},watch:{result(t){t.length>0&&this.submitVal()}},computed:{validationPending(){return void 0===this.isValid&&"off"===this.camera},validationSuccess(){return!0===this.isValid},validationFailure(){return!1===this.isValid}},methods:{update_status_wait(t){this.active_waiting=t},onDecode(t){this.result=t},handleClick(t){this.selected_row=t,this.dialog_edit=!0},edit_data(t){this.edit_aleart=t,this.dialog_edit=!0},async submitVal(){this.active_waiting=!0,this.title="",this.status="loading";var t=this.result.split("/")[1];await n["default"].axios.post(o["a"]+"/active_patient_qr",{user_scanner_id:this.$store.state.login_detail.user_id,current_qr:t},{headers:{"Content-Type":"application/json"}}).then(a=>{"this_qr_activated"==a.data.detail.status?(this.title="QR code ถูกต้อง",this.status="done",setTimeout(()=>{this.active_waiting=!1,this.$store.commit("setQrPatientId",("2"+t).slice(0,7)),this.$store.commit("setQrPatientInfo",a.data.detail.data),this.$router.push("/view_add_patient")},2e3)):"this_qr_not_correct"==a.data.detail.status?(this.active_waiting=!0,this.title="กรุณาให้ผู้ป่วยสร้าง QR ใหม่\nและลองใหม่อีกครั้ง",this.status="fail"):(this.active_waiting=!0,this.title="ระบบขัดข้อง",this.status="fail")})},async onInit(t){try{await t}catch(a){"NotAllowedError"===a.name?this.error="ERROR: you need to grant camera access permission":"NotFoundError"===a.name?this.error="ERROR: no camera on this device":"NotSupportedError"===a.name?this.error="ERROR: secure context required (HTTPS, localhost)":"NotReadableError"===a.name?this.error="ERROR: is the camera already in use?":"OverconstrainedError"===a.name?this.error="ERROR: installed cameras are not suitable":"StreamApiNotSupportedError"===a.name?this.error="ERROR: Stream API is not supported in this browser":"InsecureContextError"===a.name?this.error="ERROR: Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":this.error=`ERROR: Camera error (${a.name})`}}}},d=l,u=(e("715e"),e("2877")),h=e("6544"),v=e.n(h),m=e("8336"),p=e("b0af"),_=e("99d9"),w=e("62ad"),b=e("a523"),g=e("553a"),f=e("132d"),R=e("0fd9"),x=Object(u["a"])(d,i,r,!1,null,"6cf40f5c",null);a["default"]=x.exports;v()(x,{VBtn:m["a"],VCard:p["a"],VCardText:_["c"],VCol:w["a"],VContainer:b["a"],VFooter:g["a"],VIcon:f["a"],VRow:R["a"]})},cc12b:function(t,a,e){}}]);
//# sourceMappingURL=chunk-529534ef.eda5c7a4.js.map